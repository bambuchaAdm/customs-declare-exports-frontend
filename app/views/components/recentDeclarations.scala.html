@*
 * Copyright 2018 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import config.AppConfig
@import models.RecentDeclaration
@import utils.Page

@(appConfig: AppConfig, page: Page[RecentDeclaration], mode: RecentDeclarationMode)(implicit messages: Messages)

<style>
    .status span {
        border-width: 1px;
        border-style: solid;
        border-radius: 3px;
        display: block;
        font-size: 0.7em;
        font-weight: 600;
        padding: 1px 1px 1px 1px;
        text-align: center;
        width: 84px;
        height: 18px;
    }

    .prelodged {
        color: gray;
        border-color: gray;
    }

    .arrived {
        color: darkblue;
        border-color: darkblue;
    }

    .accepted {
        color: darkorange;
        border-color: darkorange;
    }

    .query {
        color: red;
        border-color: red;
    }

    .departed {
        color: green;
        border-color: green;
    }
</style>

<div class="recent-declarations">
    <table>
        <div class="tile-header margin-left">
            <h2 class="recent-header">@messages("recentDeclarations.title")</h2>
        </div>
        <tr class="tile-detail table">
            <td class="table-cell bold-small column-16">
                @messages("recentDeclarations.name")
            </td>
            <td class="table-cell bold-small column-16">
                @messages("recentDeclarations.date")
            </td>
            <td class="table-cell bold-small column-20">
                @messages("recentDeclarations.ducr")
            </td>
            <td class="table-cell bold-small column-16">
                @messages("recentDeclarations.status")
            </td>
            <td class="table-cell bold-small column-16">
                @messages("recentDeclarations.messages")
            </td>
            <td class="table-cell bold-small column-16">
                @messages("recentDeclarations.action")
            </td>
        </tr>
        @for(declaration <- page.elements){
            <tr class="tile-detail table">
                <td class="table-cell column-16">
                    @declaration.name
                </td>
                <td class="table-cell column-16">
                    @declaration.dateAndTime
                </td>
                <td class="table-cell column-20">
                    @declaration.ducr
                </td>
                <td class="table-cell column-16">
                    <div class="status">
                        <span class=@{declaration.status.toString.toLowerCase}>
                            @messages("recentDeclarations.status." + declaration.status.toString.toLowerCase)
                        </span>
                    </div>
                </td>
                <td class="table-cell column-16">
                    @declaration.messages
                </td>
                <td class="table-cell column-16">
                    @declaration.action
                </td>
            </tr>
        }
    </table>
    @elementsFrom = @{(page.currentPage - 1) * page.maxPerPage + 1}
    @elementsTo = @{if(page.currentPage == page.noOfPages){page.resultsLength}else{page.currentPage * page.maxPerPage}}
    @elementsNo = @{page.resultsLength}
    @currentPage = @{page.currentPage}
    @noPages = @{page.noOfPages}
    @pagesFrom = @{if(page.currentPage % 5 == 0){page.currentPage - 4}else{(page.currentPage/5) * 5 + 1}}
    @pagesTo = @{if(pagesFrom + 4 > page.noOfPages){page.noOfPages}else{pagesFrom + 4}}
    @if(currentPage > noPages){}else{
        @if(mode == Preview){@components.view_all_declarations()}else{@components.pagination(elementsFrom, elementsTo, elementsNo, pagesFrom, pagesTo, currentPage, noPages)}
    }
</div>